import { type Request, type Response } from "express";

export class VulnerabilityController {
  // GET: Obtener todas las vulnerabilidades
  static async getVulnerabilities(req: Request, res: Response) {
    try {
      // const data = await VulnerabilityService.getAll();
      const mockData = [
        { id: 1, title: "SQL Injection", severity: "High" },
        { id: 2, title: "XSS", severity: "Medium" },
      ];

      res.status(200).json({
        success: true,
        data: mockData,
      });
    } catch (error) {
      // En una app real, usarías un middleware de errores
      res
        .status(500)
        .json({ success: false, message: "Error interno del servidor" });
    }
  }

  // POST: Crear una nueva vulnerabilidad
  static async createVulnerability(req: Request, res: Response) {
    try {
      const { title, severity, description } = req.body;

      // Validación simple (idealmente usar Zod/Joi)
      if (!title || !severity) {
        return res
          .status(400)
          .json({ success: false, message: "Faltan campos requeridos" });
      }

      // const newVuln = await VulnerabilityService.create({ title, severity... });
      const mockCreated = {
        id: 3,
        title,
        severity,
        description,
        status: "Open",
      };

      res.status(201).json({
        success: true,
        message: "Vulnerabilidad registrada correctamente",
        data: mockCreated,
      });
    } catch (error) {
      res
        .status(500)
        .json({ success: false, message: "No se pudo crear el registro" });
    }
  }
}

module.exports = { VulnerabilityController };
